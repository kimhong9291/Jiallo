const main_script_chap1 = [ //img
    // -------------------- 初始場景 (保留) --------------------
    // 「」
    {   
        chapter:"第一章：與你的初次建面",
        id: 'scene_start',
        steps: [
            { name: "旁白", text: "（你在辦公室加班，突然感覺背後有一道視線。）" },
            { name: "林建成", text: "這麼晚了還在做報表？讓我看看你的格式。" }
        ],
        options: [
            { text: "緊張地遮住螢幕", score: -5, next: '1', reaction: "建成皺眉：「遮遮掩掩的，肯定是用手動計算機算的吧？」" },
            { text: "自信地展示 VLOOKUP", score: 5, next: '1', reaction: "建成點點頭：「VLOOKUP...還可以，雖然有點舊，但基礎不錯。」" },
            { text: "直接展示 XLOOKUP", score: 15, next: '1', reaction: "建成眼睛一亮：「喔？懂得用 XLOOKUP？看來你不是一般人。」" }
        ]
    },
    {
        id: '1',
        steps: [
            { name: "林建成", text: "林建成推了推眼鏡，指著你的 D 欄位。" },
            { name: "林建成", text: "這裡的數據量很大，你打算怎麼整理？" }
        ],
        options: [
            { text: "合併儲存格 (Merge Cells)", score: -20, next: '2', reaction: "建成的臉色瞬間發黑：「合併儲存格是 Excel 的萬惡之源！以後不准這樣做！」" },
            { text: "使用樞紐分析表 (Pivot Table)", score: 10, next: '2', reaction: "建成露出微笑：「明智的選擇，樞紐分析表才是效率的關鍵。」" },
            { text: "寫 VBA 巨集自動化", score: 20, next: '2', reaction: "建成臉紅了：「VBA...？這種高階技巧...我對你刮目相看了。」" }
        ]
    },
    {
        id: '2',
        steps: [
            { name: "旁白", text: "（加班結束了，林建成似乎還不想走。）" },
            { name: "林建成", text: "那個...如果你週末有空的話..." }
        ],
        options: [
            { text: "一起去吃飯嗎？", score: 5, next: '3', reaction: "建成：「吃飯？嗯，也是可以，但我原本想說的是...」" },
            { text: "教我更多 Excel 技巧吧！", score: 20, next: '3', reaction: "建成激動地握住你的手：「沒問題！我準備了一套關於 Array Formula 的課程！」" },
            { text: "我要回家睡覺了", score: -10, next: '3', reaction: "建成：「...也是，休息是為了走更長遠的路（還有寫更多公式）。」" }
        ]
    },
    {
        id: '3',
        steps: [
            { name: "旁白", text: "（你正要去影印室，卻看到建成正盯著影印機一臉困惑。）" },
            { name: "林建成", text: "…這台怎麼又卡紙？" }
        ],
        options: [
            {
                text: "（熟练）我來吧，我常修這台。",
                score: 10,
                next: '4',
                reaction: "建成驚訝：「你不只會 Excel…連影印機都…太可靠了吧？」"
            },
            {
                text: "（笑）卡纸就像合併儲存格，一旦發生就完蛋。",
                score: 5,
                next: '4',
                reaction: "建成：「哈哈…你比我還恨合併儲存格。」"
            },
            {
                text: "（认真）你要學嗎？我教你。",
                score: 15,
                next: '4',
                reaction: "建成臉紅：「【玩家名字】…你要教我？那…那我很願意學。」" // 已替換: 你 -> 【玩家名字】
            }
        ]
    },
    {
        id: '4',
        steps: [
            { name: "旁白", text: "建成盯著眼前空白的 Excel 試算表，A1 到 Z100 都像沙漠般寂寞。" },
            { name: "旁白", text: "他嘆了一口氣——因為根本沒有人提供他需要的資料。" },
            { name: "旁白", text: "他就這樣杵在螢幕前，滿腦子的公式在此刻卻成為了無能的丈夫，什麼都辦不到。" }
        ],
        options: [
            {
                text: "（無奈）唉，希望資料能自己長出來。",
                score: -10,
                next: '5',
                reaction: "建成歎氣的說：[你真會開玩笑。]"
            },
            {
                text: "拍拍建成的肩膀：[要不我們先休息吧，吃些東西，看出來你的胃就像現在的cell一樣null，我請客？]",
                score: 15,
                next: '5',
                reaction: "建成往後仰了他的辦公椅，然後抬頭說：「說的也是，我們一起去吃吧。不...不過... , 不...不用【玩家名字】請客了。」\n你看見他說完這段話後臉上略顯紅暈。" // 已替換: 不用你請客了 -> 不用【玩家名字】請客了
            },
            {
                text: "主動跟建成說：[或許...我可以幫你生成資料？]",
                score: 20,
                next: '5',
                reaction: "建成驚喜地望向後方的你：[真...真的嗎？！太好了我正愁著沒有事情做呢！]"
            }
        ]
    },
    {
        id: '5',
        steps: [
            { name: "林建成", text: "林建成給了你一份奇怪的資料表。" },
            { name: "林建成", text: "這是我平常用來測試新人能力的…你能用一行公式解決嗎？" }
        ],
        options: [
            {
                text: "使用 FILTER + UNIQUE",
                score: 15,
                next: '6',
                reaction: "建成眼睛亮了：「陣列公式…太強了，你真的不是一般人。」"
            },
            {
                text: "使用傳統的進階篩選",
                score: 5,
                next: '6',
                reaction: "建成點頭：「雖然老方法，但至少你知道原理。」"
            },
            {
                text: "我…我可以先 Google 嗎？",
                score: -20,
                next: '6',
                reaction: "建成扶了扶眼鏡：「唉…至少你誠實。」"
            }
        ]
    },
    {
        id: '6',
        steps: [
            { name: "旁白", text: "林建成因為讓顧客在自己的excel表中找出自己從來沒在表中記錄的feature，導致現在被顧客痛罵中。" }
        ],
        options: [
            {
                text: "為建成解圍，並跟顧客和上司表示自己會攬下這次的失誤的職責。",
                score: 25,
                next: '7',
                reaction: "建成回去跟我細聲說：[你其實...可以不用這樣幫我...不過，謝謝你，沒有你的話我...不知道怎麼辦了...]"
            },
            {
                text: "在顧客面前為建成打抱不平。",
                score: -25,
                next: '7',
                reaction: "發現到這真是建成的失誤，導致自己也和建成一起遭受到更難聽的罵聲。"
            },
            {
                text: "沉默，結束後私底下安慰建成。",
                score: 10,
                next: '7',
                reaction: "建成哭泣完後，緩緩說著自己下次不會犯下這樣的失誤了。"
            }
        ]
    },
    {
        id: '7',
        steps: [
            { name: "旁白", text: "在你休息期間，建成走到了你的旁邊。" },
            { name: "林建成", text: "那個，你平時有什麼遊戲推薦我玩嗎？" }
        ],
        options: [
            {
                text: "原神",
                score: 0,
                next: '8', // 導向第一個新的場景
                reaction: [
                    { name: "林建成", text: "建成點頭「原神嗎...我來玩玩看好了。」" },
                    { name: "旁白", text: "過了一段時間..." },
                    { name: "林建成", text: "看起來算傷害的公式好有趣，我也去建立自己的計算機好了。" }
                ],
            },
            {
                text: "神魔之塔",
                score: 0,
                next: '神魔之塔1', // 保留神魔之塔線路
                reaction: [
                    { name: "林建成", text: "建成點頭「神魔之塔嗎...我來玩玩看好了。」" },
                ],
            },
            {
                text: "魔法少女的魔女審判。",
                score: -10,
                next: '8', // 導向第一個新的場景
                reaction: [
                    { name: "林建成", text: "建成點頭「咦，原來你喜歡這種美少女的遊戲嗎...」" },
                    { name: "旁白", text: "看得出建成對你稍微有些失望，但藝術不被別人理解也很正常。" },
                ],
            }
        ]
    },

    // -------------------- 新增的 20 個場景 (ID: 8 - 27) --------------------

    {
        id: '8',
        steps: [
            { name: "林建成", text: "「這個 'TEXTSPLIT' 函數...為什麼我用起來總是不如預期？」" },
            { name: "旁白", text: "建成拿著最新的報告，臉上寫滿了困惑，這時候正是展現你技術實力的大好時機。" }
        ],
        options: [
            { text: "直接幫他修正公式，並詳細解釋原理。", score: 10, next: '9', reaction: "建成感動地看著你：「你真是我的救星，邏輯清晰得像 Power BI 儀表板一樣。」" },
            { text: "告訴他 Google Sheets 裡的 'SPLIT' 更簡單。", score: -5, next: '9', reaction: "建成搖頭：「報告必須用 Excel，這是原則問題！」" },
            { text: "給他一個 'ChatGPT' 的連結，讓他自己問。", score: 0, next: '9', reaction: "建成：「雖然這是個現代解法，但我更喜歡你親手教我。」" }
        ]
    },
    {
        id: '9',
        steps: [
            { name: "旁白", text: "你發現建成正在為一個客戶報告設計圖表，但他選擇的顏色和字體...實在是慘不忍睹。" },
            { name: "林建成", text: "「這張 '甜甜圈圖' 是不是很生動？我想用亮黃色代表『銷售額』。」" }
        ],
        options: [
            { text: "稱讚他，並說『用色大膽』。", score: -10, next: '10', reaction: "建成自信滿滿：「我就知道我的美感是獨一無二的。」（旁白：事實上很災難）" },
            { text: "溫和地建議他使用公司品牌色系和更簡潔的長條圖。", score: 15, next: '10', reaction: "建成沉思後點頭：「你說得對，圖表的目的在於溝通，而非炫技。」" },
            { text: "直接搶過滑鼠，五分鐘內完成一張極簡風圖表。", score: 5, next: '10', reaction: "建成驚訝地看著成品：「這、這簡直是藝術！你的資料美學太棒了！」" }
        ]
    },
    {
        id: '10',
        steps: [
            { name: "旁白", text: "早上，咖啡機壞了，辦公室裡一片哀嚎。建成顯得特別焦躁不安。" },
            { name: "林建成", text: "「沒有咖啡因，我的腦袋裡的 $\text{IFS}$ 函數都打結了，這怎麼寫得下去？」" }
        ],
        options: [
            { text: "立刻衝出去買一杯他最喜歡的黑咖啡。", score: 20, next: '11', reaction: "建成喝下咖啡後，滿足地嘆息：「你就像我公式裡的 $\text{IFERROR}$ 容錯機制一樣，總是能及時出現。」" },
            { text: "告訴他：『喝水就好，咖啡因只是心理作用。』", score: -5, next: '11', reaction: "建成眼神渙散：「別說風涼話，你不會理解 $ \text{SUMIFS}$ 沒咖啡因的痛苦。」" },
            { text: "拿出你的私人速溶咖啡，偷偷遞給他。", score: 10, next: '11', reaction: "建成感動地低語：「謝謝你...這是我們兩人之間的秘密。」" }
        ]
    },
    {
        id: '11',
        steps: [
            { name: "林建成", text: "「我們部門準備在週五舉辦一個『數據清潔工作坊』，你有興趣參加嗎？」" },
            { name: "旁白", text: "他的邀請帶有一絲期待，但聽起來更像是一場技術交流會。" }
        ],
        options: [
            { text: "答應：「當然！能跟你一起清理雜亂數據簡直是享受。」", score: 15, next: '12', reaction: "建成興奮地握拳：「太棒了！我們來一起清除所有 $\text{N/A}$ 和 $\text{#VALUE}$ 吧！」" },
            { text: "拒絕：「不了，我週末想好好休息。」", score: -5, next: '12', reaction: "建成略顯失落：「喔...好吧，數據的樂趣不是每個人都能理解的。」" },
            { text: "反問：「工作坊結束後，我們可以一起去吃晚餐嗎？」", score: 10, next: '12', reaction: "建成臉紅：「啊...這...如果你不嫌棄的話，我很樂意。」" }
        ]
    },
    {
        id: '12',
        steps: [
            { name: "旁白", text: "建成正在對著一份亂七八糟的檔案發脾氣，因為裡面的欄位命名五花八門。" },
            { name: "林建成", text: "「為什麼他們不能遵守標準的『駝峰式命名法』（$\text{CamelCase}$）？這簡直是數據犯罪！」" }
        ],
        options: [
            { text: "附和：「沒錯！我最討厭那些『空格』和『全形符號』了！」", score: 10, next: '13', reaction: "建成：「找到知音了！你真是個有原則的數據人。」" },
            { text: "建議他用 $\text{VBA}$ 批量替換，節省時間。", score: 5, next: '13', reaction: "建成：「聰明，技術永遠是解決人為錯誤的最佳方法。」" },
            { text: "安撫他：「沒關係，每個人都有自己的習慣，我們耐心點。」", score: -5, next: '13', reaction: "建成嘆氣：「唉，算了，看在你這麼溫柔的份上。」" }
        ]
    },
    {
        id: '13',
        steps: [
            { name: "旁白", text: "你們一起完成了一個重要的專案，建成突然臉色大變，電腦畫面顯示『尚未存檔』。" },
            { name: "林建成", text: "「天啊！我剛剛竟然忘了按 $ \text{Ctrl}+\text{S}$！這份報表是客戶的命脈！」" }
        ],
        options: [
            { text: "立刻嘗試 $ \text{Office}$ 的自動修復功能。", score: 15, next: '14', reaction: "建成感激地看著你：「你總是在關鍵時刻冷靜，就像 $\text{Excel}$ 的『自動儲存』一樣可靠。」" },
            { text: "嘲笑他：「建成，連 $ \text{Excel}$ 裡的 $ \text{UNDO}$ 都比你可靠。」", score: -15, next: '14', reaction: "建成沮喪地低下頭：「別說了...我已經夠自責了。」" },
            { text: "拍拍他的手：「別擔心，數據不會輕易背叛一個數據狂的。」", score: 10, next: '14', reaction: "建成被你安慰，稍微放鬆了下來，但他臉還是有點紅。" }
        ]
    },
    {
        id: '14',
        steps: [
            { name: "旁白", text: "你們都需要臨時去外地出差三天，辦公室裡剩下你們兩人準備行李。" },
            { name: "林建成", text: "「這次出差，我們是去解決一個關於『資料連結』的問題，你準備好了嗎？」" }
        ],
        options: [
            { text: "抱怨：「我還以為我們能去度假，而不是去修 $ \text{SQL}$ 連結。」", score: -5, next: '15', reaction: "建成：「數據人的浪漫就是修 $ \text{bug}$，不是沙灘和陽光！」" },
            { text: "興奮地說：「能跟你一起出差，就算是去修伺服器也很有趣！」", score: 20, next: '15', reaction: "建成臉紅：「能...能跟你一起工作，確實，讓這趟旅程更有意義了。」" },
            { text: "問：「我們的房間會不會被安排在隔壁？」", score: 10, next: '15', reaction: "建成結巴：「這...這不歸我管，但...但我可以去問問。」" }
        ]
    },
    {
        id: '15',
        steps: [
            { name: "旁白", text: "在出差期間的一個深夜，你們進行了一次跨時區的視訊會議。" },
            { name: "林建成", text: "「客戶問的這個問題，我覺得可以用 $\text{DAX}$ 語言的 $ \text{CALCULATE}$ 函數來解決。」" }
        ],
        options: [
            { text: "你立刻接話：「沒錯，但要搭配 $ \text{ALL}$ 函數來忽略篩選器！」", score: 15, next: '16', reaction: "建成投給你一個默契的眼神：「太厲害了，我們簡直是數據界的『神鵰俠侶』！」" },
            { text: "打斷他：「我覺得用 $ \text{Python}$ 寫腳本比較快。」", score: -10, next: '16', reaction: "建成：「雖然 $ \text{Python}$ 很強大，但 $\text{DAX}$ 才是 $ \text{Power BI}$ 的核心浪漫啊！」" },
            { text: "靜靜聽他說完，然後在聊天室發送一個愛心 $ \text{emoji}$。", score: 5, next: '16', reaction: "建成看到愛心，頓了一下，輕輕咳了一聲，但嘴角卻微微上揚。" }
        ]
    },
    {
        id: '16',
        steps: [
            { name: "旁白", text: "今天是建成的生日，他卻一如往常地坐在電腦前，甚至忘了今天是他的大日子。" },
            { name: "林建成", text: "「今天的進度條 $ \text{Progress Bar}$ 好像有點慢，我得趕快完成。」" }
        ],
        options: [
            { text: "為他準備一個 Excel 造型的蛋糕。", score: 20, next: '17', reaction: "建成看到蛋糕上用糖霜寫著 $ \text{=TODAY()}$ 時，激動得說不出話：「這是我收過最浪漫的禮物！」" },
            { text: "裝作不知道，讓他繼續工作。", score: -10, next: '17', reaction: "建成在深夜時才發現，有點失落：「唉，看來只有數據會記得我。」" },
            { text: "輕聲唱生日歌，並送他一本最新的 $ \text{Python}$ 數據分析書。", score: 15, next: '17', reaction: "建成感動地說：「這本書對我來說，比 $ \text{iPhone}$ 還珍貴。」" }
        ]
    },
    {
        id: '17',
        steps: [
            { name: "旁白", text: "建成交給你一份充滿重複值、錯誤格式和缺失值的『地獄級』數據表。" },
            { name: "林建成", text: "「這是我們部門今年最大的挑戰，你敢接受這個『數據清潔』的試煉嗎？」" }
        ],
        options: [
            { text: "自信地說：「交給我，我會用 $ \text{Power Query}$ 在十分鐘內解決！」", score: 15, next: '18', reaction: "建成：「哇！你簡直是數據界的『去污劑』，把所有雜質都清除得一乾二淨。」" },
            { text: "哀嚎：「這根本不是人能處理的！我申請退出！」", score: -20, next: '18', reaction: "建成失望地搖頭：「連你都放棄了，看來這個數據真的無藥可救了。」" },
            { text: "問：「我們可以一起完成嗎？這樣我能學到更多。」", score: 10, next: '18', reaction: "建成微笑：「當然，我們是數據雙人組，沒有什麼是我們解決不了的。」" }
        ]
    },
    {
        id: '18',
        steps: [
            { name: "旁白", text: "建成正在興奮地向你展示他剛學會的 $\text{Power BI}$ 新功能。" },
            { name: "林建成", text: "「有了它，我們就能從 $ \text{Excel}$ 的世界，躍升到 $ \text{數據視覺化}$ 的新次元了！」" }
        ],
        options: [
            { text: "告訴他你已經是 $\text{Tableau}$ 的專家了。", score: 5, next: '19', reaction: "建成：「喔...英雄所見略同！但 $ \text{Power BI}$ 和 $ \text{Excel}$ 才是絕配！」" },
            { text: "真誠地稱讚：「建成，你對數據的熱情真的感染了我。」", score: 15, next: '19', reaction: "建成臉頰泛紅：「我...我只是想讓你看到數據裡的美。」" },
            { text: "建議他：「不如我們用 $\text{Power BI}$ 來分析一下我們的『好感度』數據吧？」", score: 20, next: '19', reaction: "建成震驚：「好感度分析？這...這太私密了...但這個想法太有創意了！」" }
        ]
    },
    {
        id: '19',
        steps: [
            { name: "旁白", text: "你收到了一封匿名郵件，內容是一行只有建成才懂得 $ \text{Lambda}$ 函數代碼。" },
            { name: "旁白", text: "郵件的主旨寫著：『我在 $\text{A1}$ 等你。』" },
            { name: "林建成", text: "建成走過來，輕咳一聲：「今天天氣不錯...你在看什麼？」" }
        ],
        options: [
            { text: "假裝沒看到，回他：「我在看 $ \text{A1}$ 儲存格裡的數據呢。」", score: 10, next: '20', reaction: "建成微笑：「是嗎？ $ \text{A1}$ 裡藏著很多秘密喔。」" },
            { text: "直接問他：「這是你寄給我的匿名郵件嗎？」", score: 15, next: '20', reaction: "建成慌張地推了推眼鏡：「什...什麼郵件？我不知道你在說什麼！」" },
            { text: "回覆郵件：『$ \text{A1}$ 是空的，但我的心裡有人了。』", score: 20, next: '20', reaction: "建成在旁邊的手機震動了一下，他看了一眼手機，臉色爆紅，轉身快步離開。" }
        ]
    },
    {
        id: '20',
        steps: [
            { name: "旁白", text: "週末，你發現建成在公司附近的圖書館裡，他面前擺滿了關於『$ \text{Python}$ 與數據科學』的書籍。" },
            { name: "林建成", text: "「我不能只停留在 $\text{Excel}$，數據的世界還有更廣闊的宇宙。」" }
        ],
        options: [
            { text: "買兩杯咖啡，陪他一起讀書。", score: 15, next: '21', reaction: "建成感動：「謝謝你，有你在，學習的效率都提高了 $ \text{200%}$。」" },
            { text: "問他：「你該不會是想轉職做數據科學家吧？」", score: 5, next: '21', reaction: "建成：「我只是想讓我的 $ \text{Excel}$ 公式更具 $ \text{AI}$ 智能。」" },
            { text: "輕輕靠在他的肩膀上，假裝睡著。", score: 10, next: '21', reaction: "建成全身僵硬，但慢慢放輕了呼吸，讓你安穩地靠著，心跳卻快得像 $ \text{CPU}$ 滿載運轉。" }
        ]
    },
    {
        id: '21',
        steps: [
            { name: "旁白", text: "建成給了你一份需要保密的 $ \text{Excel}$ 檔，並輕聲告訴你密碼。" },
            { name: "林建成", text: "「密碼是『$ \text{IF(TRUE, Love, Data)}$』，你記住了嗎？」" }
        ],
        options: [
            { text: "假裝沒聽懂，要求他再說一次。", score: 15, next: '22', reaction: "建成無奈地笑著，又重複了一遍，語氣比剛剛更溫柔了一點。" },
            { text: "微笑：「我記住了，$ \text{Love}$ 永遠排在 $ \text{Data}$ 前面。」", score: 20, next: '22', reaction: "建成臉紅到脖子根：「【玩家名字】、你別多想，這只是個隨機密碼！」" }, // 已替換: 你、你別多想 -> 【玩家名字】、你別多想
            { text: "吐槽：「這種密碼強度也太低了吧？」", score: -5, next: '22', reaction: "建成：「...但這是我能想到的，最讓我安心的組合了。」" }
        ]
    },
    {
        id: '22',
        steps: [
            { name: "旁白", text: "你的電腦突然藍屏，文件全部消失，建成立刻衝過來關心你。" },
            { name: "林建成", text: "「怎麼了？文件都還好嗎？快，讓我檢查一下你的硬碟 $ \text{Condition}$！」" }
        ],
        options: [
            { text: "抱著他大哭：「我的 $ \text{Array Formula}$ 全都沒了！」", score: 10, next: '23', reaction: "建成溫柔地拍著你的背：「沒事，沒事，我會幫你寫回來，而且寫得更好。」" },
            { text: "坦白：「其實我是想騙你過來幫我修一個 $ \text{VLOOKUP}$ 錯誤。」", score: -10, next: '23', reaction: "建成無語：「你竟然拿『藍屏』來開玩笑？這很不 $ \text{Excel}$！」" },
            { text: "冷靜地說：「沒關係，我昨晚已經在雲端備份了，這是數據人的基本修養。」", score: 15, next: '23', reaction: "建成欣慰地笑著：「太好了，你真的是數據界的天才，讓我無比心動。」" }
        ]
    },
    {
        id: '23',
        steps: [
            { name: "旁白", text: "在一次午餐時間，建成突然聊起了他對數據可視化的哲學。" },
            { name: "林建成", text: "「一個好的圖表，應該像一個愛情故事一樣，簡潔、有力、直擊人心。」" }
        ],
        options: [
            { text: "問他：「那你的愛情故事是什麼樣的？」", score: 20, next: '24', reaction: "建成臉紅，低頭看著碗裡的飯：「我...我的愛情故事，還在等待一個『$ \text{TRUE}$』的條件成立。」" },
            { text: "同意：「但太多花哨的顏色就像愛情裡的謊言。」", score: 10, next: '24', reaction: "建成：「沒錯！數據要純淨，愛情要真誠！」" },
            { text: "嘲諷：「你是不是把 $\text{Excel}$ 玩成了戀愛遊戲了？」", score: -5, next: '24', reaction: "建成嘟囔：「有什麼不好？生活處處是數據，處處是浪漫。」" }
        ]
    },
    {
        id: '24',
        steps: [
            { name: "旁白", text: "你聽見兩個同事在角落竊竊私語，談論你和建成走得太近的事。" },
            { name: "同事 A", text: "「你看他們倆，整天不是在講 $ \text{INDEX}$ 就是 $ \text{MATCH}$，他們肯定有問題！」" }
        ],
        options: [
            { text: "大聲走過去：「我們只是在討論 $ \text{SQL}$ 查詢語法，你們有意見嗎？」", score: -10, next: '25', reaction: "同事們立刻閉嘴，但建成皺眉：「不需要這麼咄咄逼人。」" },
            { text: "拉著建成就跑，假裝沒聽到。", score: 15, next: '25', reaction: "建成被你拉著，臉紅地問：「發生什麼事了？...但被你拉著，感覺很特別。」" },
            { text: "跟建成說：「看來我們得在辦公室裡保持一點『安全距離』了。」", score: 5, next: '25', reaction: "建成失落：「安全距離...是嗎？但我覺得 $ \text{0}$ 距離才最有效率。」" }
        ]
    },
    {
        id: '25',
        steps: [
            { name: "旁白", text: "你們被指派了第一個共同專案，你們必須合作完成一個複雜的財務模型。" },
            { name: "林建成", text: "「這個模型有 $ \text{50}$ 個輸入參數和 $ \text{100}$ 個公式，我們來分配工作吧。」" }
        ],
        options: [
            { text: "要求跟他一起完成最核心、最難的 $ \text{Array Formula}$ 部分。", score: 20, next: '26', reaction: "建成眼神充滿讚賞：「你真有魄力！我們一起挑戰這個 $ \text{Excel}$ 裡的珠穆朗瑪峰吧！」" },
            { text: "讓他負責公式，你負責設計介面和美化。", score: 10, next: '26', reaction: "建成：「你的介面設計總是那麼乾淨，就像洗淨的數據一樣。」" },
            { text: "偷偷做了一個 $ \text{Excel}$ 彩蛋，讓 $ \text{Logo}$ 變成一個愛心。", score: 15, next: '26', reaction: "建成發現彩蛋後，羞澀地笑了：「你...你真是個浪漫的數據人。」" }
        ]
    },
    {
        id: '26',
        steps: [
            { name: "旁白", text: "你在茶水間泡咖啡時，意外聽到建成在跟同事聊天。" },
            { name: "林建成", text: "…她的公式寫得比我想像中還好，和...和他的溫柔一樣好..." }
        ],
        options: [
            {
                text: "（走出去）你剛剛是在稱讚我嗎？",
                score: 15,
                next: '27', 
                reaction: "建成被你嚇到：「咳咳…我、我只是在講事實。」"
            },
            {
                text: "（偷聽到最後）嘻…再講多一點嘛",
                score: 10,
                next: '27', 
                reaction: "建成忽然察覺：「欸？【玩家名字】你在那邊很久了…？」" // 已替換: 你 -> 【玩家名字】
            },
            {
                text: "（假装没听到）默默离开",
                score: 5,
                next: '27', 
                reaction: "建成後來追上你：「你剛剛是不是…算了，當我沒說。」"
            }
        ]
    },

    {
        id: '27',
        steps: [
            { name: "旁白", text: "專案完成後，你們在頂樓的露台吹風，談論著未來。" },
            { name: "林建成", text: "「我夢想中的未來，就是一個沒有合併儲存格、所有數據都能自動更新的世界。」" }
        ],
        options: [
            { text: "笑著說：「我的夢想是，我的未來裡有你。」", score: 25, next: '28', reaction: "建成全身一震，轉頭凝視著你：「【玩家名字】、你說什麼？這個 $ \text{Formula}$ 突然讓我的 $ \text{CPU}$ 過載了！」" }, // 已替換: 你、你說什麼 -> 【玩家名字】、你說什麼
            { text: "問他：「如果離開 $ \text{Excel}$，你會想做什麼？」", score: 5, next: '28', reaction: "建成沉思：「沒有 $ \text{Excel}$ 的世界...就像沒有公式的愛情一樣，空虛。」" },
            { text: "提議：「那我們一起創立一家『數據清潔公司』吧！」", score: 10, next: '28', reaction: "建成興奮：「這聽起來像是一個 $ \text{Start-up}$，我很喜歡這個主意！」" }
        ]
    },
    {
        id: '28',
        steps: [
            { name: "旁白", text: "建成拿出了一張 $ \text{Excel}$ 的 $ \text{IF}$ 函數流程圖，指著其中的 $ \text{Value\_if\_true}$ 部分。" },
            { name: "林建成", text: "「這個 $ \text{TRUE}$ 條件，我現在已經準備好了。但 $ \text{Value\_if\_true}$ 的結果，需要你來填寫。」" }
        ],
        options: [
            { text: "填寫：『永遠在一起』", score: 20, next: '29', reaction: "建成眼中充滿光芒：「我會盡我所能，讓這個 $ \text{Value}$ 永遠成立！」" },
            { text: "填寫：『繼續做朋友』", score: -20, next: '29', reaction: "建成臉色一僵：「喔...原來如此，我明白了。」" },
            { text: "填寫：『先從約會開始』", score: 15, next: '29', reaction: "建成露出靦腆的笑容：「約會...這是一個非常好的 $ \text{Step-by-step}$ 流程。」" }
        ]
    },

    
    {
        id: '29',
        steps: [
            { name: "旁白", text: "（這是最後的關鍵時刻...）" },
            { name: "林建成", text: "林建成拿出一份試算表，上面的儲存格拼成了一個愛心形狀。" }
        ],
        options: [
            { text: "「這是條件式格式設定嗎？好美！」", score: 20, next: 'ending_check', reaction: "建成：「沒錯！是利用 $ROW 和 $COLUMN 參數算出來的！你竟然懂！」" },
            { text: "「你的欄寬好像沒有調整好。」", score: -30, next: 'ending_check', reaction: "建成：「（臉色蒼白）...對不起，是我太粗心了。」" },
            { text: "默默存檔並備份", score: 10, next: 'ending_check', reaction: "建成：「你真是個優秀的數據人，永遠把資料安全放在第一位。」" }
        ]
    },

    {
        id: '29_A',
        steps: [
            { name: "旁白", text: "（這是最後的關鍵時刻...）" },
            { name: "林建成", text: "林建成拿出一份試算表，上面都是滿滿的神魔之塔隊伍，就和彙整串一樣。" },
            { name: "旁白", text: "你看見了sheet欄目有一個特殊的名字，名曰：？？之塔" },
            { name: "旁白", text: "點開一看，那邊只有一行隊伍，但是缺少了隊長戰友，隊員格則是滿滿的建成照片，而優先度那裡也是空白的。" },
            { name: "旁白", text: "經過許久的相處，你早已知道這張試算表對你對他而言到底是什麼。" },
        ],
        options: [
            {
                text: "「？？分別代表的是你和我嗎？」", score: 0, next: 'ending_check_TOS',
                reaction: [{ name: "建成", text: "「沒錯！如果我是惡魔，那你就是我的神，我們相輔相成，我們已鑄偉業。」" },
                    { name: "建成", text: "「在神魔之塔中，這將是一個不同以往的浪漫故事。」" }
                ]
            },
            {
                text: "「空白是我的位置嗎？」", score: 0, next: 'ending_check_TOS',
                reaction: [{ name: "建成", text: "「隊員無論如何多強，但只有隊長才能讓他們發揚光大。」" },
                { name: "建成", text: "「而你對我而言，是我的隊長。」" },
                ]
            },
            {
                text: "默默在[優先度]欄填寫優先度0", score: 0, next: 'ending_check_TOS',
                reaction:
                    [{ name: "建成", text: "建成對此感到開心。" },
                    { name: "建成", text: "「我見過許多的優先1,2,3。」" },
                    { name: "建成", text: "「但我知道你一定會寫0，因為優先度0是規矩的例外。」" },
                    { name: "建成", text: "「我和你的優先度一直都是最高的，你說對吧？」" },]
            },
        ]
    },

    {
        id: '29_Silver',
        steps: [
            { name: "旁白", text: "（這是最後的關鍵時刻...）" },
            { name: "林建成", text: "林建成拿出一份試算表，上面都是滿滿的神魔之塔隊伍，就和彙整串一樣。" },
            { name: "旁白", text: "你看見了sheet欄目有一個特殊的名字，名曰：？？之塔" },
            { name: "旁白", text: "點開一看，那邊只有一行隊伍，但是缺少了隊長戰友，隊員格則是滿滿的建成照片，而優先度那裡也是空白的。" },
            { name: "旁白", text: "經過許久的相處，你早已知道這張試算表對你對他而言到底是什麼。" },
        ],
        options: [
            {
                text: "「？？分別代表的是你和我嗎？」", score: 0, next: 'ending_check_TOSS',
                reaction: [{ name: "建成", text: "「沒錯！如果我是惡魔，那你就是我的神，我們相輔相成，我們已鑄偉業。」" },
                    { name: "建成", text: "「在神魔之塔中，這將是一個不同以往的浪漫故事。」" }
                ]
            },
            {
                text: "「空白是我的位置嗎？」", score: 0, next: 'ending_check_TOSS',
                reaction: [{ name: "建成", text: "「隊員無論如何多強，但只有隊長才能讓他們發揚光大。」" },
                { name: "建成", text: "「而你對我而言，是我的隊長。」" },
                ]
            },
            {
                text: "默默在[優先度]欄填寫優先度0", score: 0, next: 'ending_check_TOSS',
                reaction:
                    [{ name: "建成", text: "建成對此感到開心。" },
                    { name: "建成", text: "「我見過許多的優先1,2,3。」" },
                    { name: "建成", text: "「但我知道你一定會寫0，因為優先度0是規矩的例外。」" },
                    { name: "建成", text: "「我和你的優先度一直都是最高的，你說對吧？」" },]
            },
            {
                text: "你給我表是要你坐在我身上喘哦！？", score: 0, next: 'ending_check_TOSS',
                reaction:
                    [{ name: "建成", text: "建成已經沉醉在這份諾言中。" },
                    { name: "旁白", text: "至此這是第一章對第二章的喘承。" },
                    ]
            },
        ]
    },
]

exports.handler = async (event, context) => {
    return {
        statusCode: 200,
        headers: {
            'Content-Type': 'application/json',
            'Access-Control-Allow-Origin': '*' 
        },
        // 只回傳主線劇本
        body: JSON.stringify(main_script_chap1), 
    };
};